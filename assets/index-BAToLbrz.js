var ir=Object.defineProperty;var Ft=e=>{throw TypeError(e)};var nr=(e,t,r)=>t in e?ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var y=(e,t,r)=>nr(e,typeof t!="symbol"?t+"":t,r),Ee=(e,t,r)=>t.has(e)||Ft("Cannot "+r);var n=(e,t,r)=>(Ee(e,t,"read from private field"),r?r.call(e):t.get(e)),f=(e,t,r)=>t.has(e)?Ft("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),u=(e,t,r,s)=>(Ee(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),l=(e,t,r)=>(Ee(e,t,"access private method"),r);var w,g,kt,re=(kt=class{constructor(e){f(this,w);f(this,g,0);u(this,w,new DataView(e.buffer)),u(this,g,e.byteOffset)}get offset(){return n(this,g)}readUInt8Array(){const e=this.readU32(),t=new Uint8Array(n(this,w).buffer,n(this,g),e);return u(this,g,n(this,g)+e),t}readBool(){const e=n(this,w).getUint8(n(this,g));return u(this,g,n(this,g)+1),e!==0}readByte(){const e=n(this,w).getUint8(n(this,g));return u(this,g,n(this,g)+1),e}readBytes(e){const t=new DataView(n(this,w).buffer,n(this,g),e);return u(this,g,n(this,g)+e),new Uint8Array(t.buffer)}readI8(){const e=n(this,w).getInt8(n(this,g));return u(this,g,n(this,g)+1),e}readU8(){const e=n(this,w).getUint8(n(this,g));return u(this,g,n(this,g)+1),e}readI16(){const e=n(this,w).getInt16(n(this,g),!0);return u(this,g,n(this,g)+2),e}readU16(){const e=n(this,w).getUint16(n(this,g),!0);return u(this,g,n(this,g)+2),e}readI32(){const e=n(this,w).getInt32(n(this,g),!0);return u(this,g,n(this,g)+4),e}readU32(){const e=n(this,w).getUint32(n(this,g),!0);return u(this,g,n(this,g)+4),e}readI64(){const e=n(this,w).getBigInt64(n(this,g),!0);return u(this,g,n(this,g)+8),e}readU64(){const e=n(this,w).getBigUint64(n(this,g),!0);return u(this,g,n(this,g)+8),e}readU128(){const e=n(this,w).getBigUint64(n(this,g),!0),t=n(this,w).getBigUint64(n(this,g)+8,!0);return u(this,g,n(this,g)+16),(t<<BigInt(64))+e}readI128(){const e=n(this,w).getBigUint64(n(this,g),!0),t=n(this,w).getBigInt64(n(this,g)+8,!0);return u(this,g,n(this,g)+16),(t<<BigInt(64))+e}readU256(){const e=n(this,w).getBigUint64(n(this,g),!0),t=n(this,w).getBigUint64(n(this,g)+8,!0),r=n(this,w).getBigUint64(n(this,g)+16,!0),s=n(this,w).getBigUint64(n(this,g)+24,!0);return u(this,g,n(this,g)+32),(s<<BigInt(192))+(r<<BigInt(128))+(t<<BigInt(64))+e}readI256(){const e=n(this,w).getBigUint64(n(this,g),!0),t=n(this,w).getBigUint64(n(this,g)+8,!0),r=n(this,w).getBigUint64(n(this,g)+16,!0),s=n(this,w).getBigInt64(n(this,g)+24,!0);return u(this,g,n(this,g)+32),(s<<BigInt(192))+(r<<BigInt(128))+(t<<BigInt(64))+e}readF32(){const e=n(this,w).getFloat32(n(this,g),!0);return u(this,g,n(this,g)+4),e}readF64(){const e=n(this,w).getFloat64(n(this,g),!0);return u(this,g,n(this,g)+8),e}readString(){const e=this.readU32(),t=new Uint8Array(n(this,w).buffer,n(this,g),e),s=new TextDecoder("utf-8").decode(t);return u(this,g,n(this,g)+e),s}},w=new WeakMap,g=new WeakMap,kt),E,I,d,F,B,Pt,V=(Pt=class{constructor(e){f(this,F);f(this,E);f(this,I);f(this,d,0);u(this,E,new Uint8Array(e)),u(this,I,new DataView(n(this,E).buffer))}getBuffer(){return n(this,E).slice(0,n(this,d))}writeUInt8Array(e){const t=e.length;l(this,F,B).call(this,4+t),this.writeU32(t),n(this,E).set(e,n(this,d)),u(this,d,n(this,d)+e.length)}writeBool(e){l(this,F,B).call(this,1),n(this,I).setUint8(n(this,d),e?1:0),u(this,d,n(this,d)+1)}writeByte(e){l(this,F,B).call(this,1),n(this,I).setUint8(n(this,d),e),u(this,d,n(this,d)+1)}writeI8(e){l(this,F,B).call(this,1),n(this,I).setInt8(n(this,d),e),u(this,d,n(this,d)+1)}writeU8(e){l(this,F,B).call(this,1),n(this,I).setUint8(n(this,d),e),u(this,d,n(this,d)+1)}writeI16(e){l(this,F,B).call(this,2),n(this,I).setInt16(n(this,d),e,!0),u(this,d,n(this,d)+2)}writeU16(e){l(this,F,B).call(this,2),n(this,I).setUint16(n(this,d),e,!0),u(this,d,n(this,d)+2)}writeI32(e){l(this,F,B).call(this,4),n(this,I).setInt32(n(this,d),e,!0),u(this,d,n(this,d)+4)}writeU32(e){l(this,F,B).call(this,4),n(this,I).setUint32(n(this,d),e,!0),u(this,d,n(this,d)+4)}writeI64(e){l(this,F,B).call(this,8),n(this,I).setBigInt64(n(this,d),e,!0),u(this,d,n(this,d)+8)}writeU64(e){l(this,F,B).call(this,8),n(this,I).setBigUint64(n(this,d),e,!0),u(this,d,n(this,d)+8)}writeU128(e){l(this,F,B).call(this,16);const t=e&BigInt("0xFFFFFFFFFFFFFFFF"),r=e>>BigInt(64);n(this,I).setBigUint64(n(this,d),t,!0),n(this,I).setBigUint64(n(this,d)+8,r,!0),u(this,d,n(this,d)+16)}writeI128(e){l(this,F,B).call(this,16);const t=e&BigInt("0xFFFFFFFFFFFFFFFF"),r=e>>BigInt(64);n(this,I).setBigInt64(n(this,d),t,!0),n(this,I).setBigInt64(n(this,d)+8,r,!0),u(this,d,n(this,d)+16)}writeU256(e){l(this,F,B).call(this,32);const t=BigInt("0xFFFFFFFFFFFFFFFF"),r=e&t,s=e>>BigInt(64*1)&t,i=e>>BigInt(64*2)&t,c=e>>BigInt(64*3);n(this,I).setBigUint64(n(this,d)+8*0,r,!0),n(this,I).setBigUint64(n(this,d)+8*1,s,!0),n(this,I).setBigUint64(n(this,d)+8*2,i,!0),n(this,I).setBigUint64(n(this,d)+8*3,c,!0),u(this,d,n(this,d)+32)}writeI256(e){l(this,F,B).call(this,32);const t=BigInt("0xFFFFFFFFFFFFFFFF"),r=e&t,s=e>>BigInt(64*1)&t,i=e>>BigInt(64*2)&t,c=e>>BigInt(64*3);n(this,I).setBigUint64(n(this,d)+8*0,r,!0),n(this,I).setBigUint64(n(this,d)+8*1,s,!0),n(this,I).setBigUint64(n(this,d)+8*2,i,!0),n(this,I).setBigInt64(n(this,d)+8*3,c,!0),u(this,d,n(this,d)+32)}writeF32(e){l(this,F,B).call(this,4),n(this,I).setFloat32(n(this,d),e,!0),u(this,d,n(this,d)+4)}writeF64(e){l(this,F,B).call(this,8),n(this,I).setFloat64(n(this,d),e,!0),u(this,d,n(this,d)+8)}writeString(e){const r=new TextEncoder().encode(e);this.writeU32(r.length),l(this,F,B).call(this,r.length),n(this,E).set(r,n(this,d)),u(this,d,n(this,d)+r.length)}},E=new WeakMap,I=new WeakMap,d=new WeakMap,F=new WeakSet,B=function(e){const t=n(this,d)+e+1;if(t<=n(this,E).length)return;let r=n(this,E).length*2;r<t&&(r=t);const s=new Uint8Array(r);s.set(n(this,E)),u(this,E,s),u(this,I,new DataView(n(this,E).buffer))},Pt);function It(e,t){if(e===t)return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(let i of r)if(!s.includes(i)||!It(e[i],t[i]))return!1;return!0}function Nt(e){return Array.prototype.map.call(e,t=>("00"+t.toString(16)).slice(-2)).join("")}function sr(e){if(e.length!=16)throw new Error(`Uint8Array is not 16 bytes long: ${e}`);return new re(e).readU128()}function ar(e){if(e.length!=32)throw new Error(`Uint8Array is not 32 bytes long: [${e}]`);return new re(e).readU256()}function Mt(e){e.startsWith("0x")&&(e=e.slice(2));let t=e.match(/.{1,2}/g)||[],r=Uint8Array.from(t.map(s=>parseInt(s,16)));return r.length!=32?new Uint8Array(0):r}function cr(e){return sr(Mt(e))}function or(e){return ar(Mt(e))}function Lt(e){let t=new V(16);return t.writeU128(e),t.getBuffer()}function pr(e){return Nt(Lt(e))}function Ht(e){let t=new V(32);return t.writeU256(e),t.getBuffer()}function lr(e){return Nt(Ht(e))}var Re=class Ae{constructor(t){y(this,"data");this.data=t}get __connection_id__(){return this.data}isZero(){return this.data===BigInt(0)}static nullIfZero(t){return t.isZero()?null:t}static random(){function t(){return Math.floor(Math.random()*255)}let r=BigInt(0);for(let s=0;s<16;s++)r=r<<BigInt(8)|BigInt(t());return new Ae(r)}isEqual(t){return this.data==t.data}toHexString(){return pr(this.data)}toUint8Array(){return Lt(this.data)}static fromString(t){return new Ae(cr(t))}static fromStringOrNull(t){let r=Ae.fromString(t);return r.isZero()?null:r}},N,ur=(N=class{constructor(t){y(this,"__time_duration_micros__");this.__time_duration_micros__=t}get micros(){return this.__time_duration_micros__}get millis(){return Number(this.micros/N.MICROS_PER_MILLIS)}static fromMillis(t){return new N(BigInt(t)*N.MICROS_PER_MILLIS)}},y(N,"MICROS_PER_MILLIS",1000n),N),D,yr=(D=class{constructor(t){y(this,"__timestamp_micros_since_unix_epoch__");this.__timestamp_micros_since_unix_epoch__=t}get microsSinceUnixEpoch(){return this.__timestamp_micros_since_unix_epoch__}static now(){return D.fromDate(new Date)}static fromDate(t){const r=t.getTime(),s=BigInt(r)*D.MICROS_PER_MILLIS;return new D(s)}toDate(){const r=this.__timestamp_micros_since_unix_epoch__/D.MICROS_PER_MILLIS;if(r>BigInt(Number.MAX_SAFE_INTEGER)||r<BigInt(Number.MIN_SAFE_INTEGER))throw new RangeError("Timestamp is outside of the representable range of JS's Date");return new Date(Number(r))}},y(D,"MICROS_PER_MILLIS",1000n),y(D,"UNIX_EPOCH",new D(0n)),D),gr=class $t{constructor(t){y(this,"data");this.data=typeof t=="string"?or(t):t}get __identity__(){return this.data}isEqual(t){return this.toHexString()===t.toHexString()}toHexString(){return lr(this.data)}toUint8Array(){return Ht(this.data)}static fromString(t){return new $t(t)}},De;(e=>{function t(){return a.createSumType([new U("Interval",a.createU64Type()),new U("Time",a.createU64Type())])}e.getAlgebraicType=t;function r(i){switch(i.tag){case"Interval":return{Interval:i.value};case"Time":return{Time:i.value};default:throw"unreachable"}}e.serialize=r,e.Interval=i=>({tag:"Interval",value:i}),e.Time=i=>({tag:"Time",value:i});function s(i){let c=i.asSumValue();switch(c.tag){case 0:return{tag:"Interval",value:c.value.asBigInt()};case 1:return{tag:"Time",value:c.value.asBigInt()};default:throw"unreachable"}}e.fromValue=s})(De||(De={}));var dr=De,U=class{constructor(e,t){y(this,"name");y(this,"algebraicType");this.name=e,this.algebraicType=t}},hr=class{constructor(e){y(this,"variants");y(this,"serialize",(e,t)=>{if(this.variants.length==2&&this.variants[0].name==="some"&&this.variants[1].name==="none")t?(e.writeByte(0),this.variants[0].algebraicType.serialize(e,t)):e.writeByte(1);else{let r=t.tag;const s=this.variants.findIndex(i=>i.name===r);if(s<0)throw`Can't serialize a sum type, couldn't find ${t.tag} tag`;e.writeU8(s),this.variants[s].algebraicType.serialize(e,t.value)}});y(this,"deserialize",e=>{let t=e.readU8();if(this.variants.length==2&&this.variants[0].name==="some"&&this.variants[1].name==="none"){if(t===0)return this.variants[0].algebraicType.deserialize(e);if(t===1)return;throw`Can't deserialize an option type, couldn't find ${t} tag`}else{let r=this.variants[t],s=r.algebraicType.deserialize(e);return{tag:r.name,value:s}}});this.variants=e}},o=class{constructor(e,t){y(this,"name");y(this,"algebraicType");this.name=e,this.algebraicType=t}},Tr=class{constructor(e){y(this,"elements");y(this,"serialize",(e,t)=>{for(let r of this.elements)r.algebraicType.serialize(e,t[r.name])});y(this,"deserialize",e=>{let t={};if(this.elements.length===1){if(this.elements[0].name==="__time_duration_micros__")return new ur(e.readI64());if(this.elements[0].name==="__timestamp_micros_since_unix_epoch__")return new yr(e.readI64());if(this.elements[0].name==="__identity__")return new gr(e.readU256());if(this.elements[0].name==="__connection_id__")return new Re(e.readU128())}for(let r of this.elements)t[r.name]=r.algebraicType.deserialize(e);return t});this.elements=e}isEmpty(){return this.elements.length===0}},br=class{constructor(e,t){y(this,"keyType");y(this,"valueType");this.keyType=e,this.valueType=t}},P,Q,_,G,v,qe,Ne,Me,a=(G=class{constructor(){f(this,P);y(this,"type");y(this,"type_")}get product(){if(this.type!==p.ProductType)throw"product type was requested, but the type is not ProductType";return this.type_}set product(t){l(this,P,Q).call(this,p.ProductType,t)}get sum(){if(this.type!==p.SumType)throw"sum type was requested, but the type is not SumType";return this.type_}set sum(t){l(this,P,Q).call(this,p.SumType,t)}get array(){if(this.type!==p.ArrayType)throw"array type was requested, but the type is not ArrayType";return this.type_}set array(t){l(this,P,Q).call(this,p.ArrayType,t)}get map(){if(this.type!==p.MapType)throw"map type was requested, but the type is not MapType";return this.type_}set map(t){l(this,P,Q).call(this,p.MapType,t)}static createProductType(t){return l(this,_,v).call(this,p.ProductType,new Tr(t))}static createSumType(t){return l(this,_,v).call(this,p.SumType,new hr(t))}static createArrayType(t){return l(this,_,v).call(this,p.ArrayType,t)}static createMapType(t,r){return l(this,_,v).call(this,p.MapType,new br(t,r))}static createBoolType(){return l(this,_,v).call(this,p.Bool,null)}static createI8Type(){return l(this,_,v).call(this,p.I8,null)}static createU8Type(){return l(this,_,v).call(this,p.U8,null)}static createI16Type(){return l(this,_,v).call(this,p.I16,null)}static createU16Type(){return l(this,_,v).call(this,p.U16,null)}static createI32Type(){return l(this,_,v).call(this,p.I32,null)}static createU32Type(){return l(this,_,v).call(this,p.U32,null)}static createI64Type(){return l(this,_,v).call(this,p.I64,null)}static createU64Type(){return l(this,_,v).call(this,p.U64,null)}static createI128Type(){return l(this,_,v).call(this,p.I128,null)}static createU128Type(){return l(this,_,v).call(this,p.U128,null)}static createI256Type(){return l(this,_,v).call(this,p.I256,null)}static createU256Type(){return l(this,_,v).call(this,p.U256,null)}static createF32Type(){return l(this,_,v).call(this,p.F32,null)}static createF64Type(){return l(this,_,v).call(this,p.F64,null)}static createStringType(){return l(this,_,v).call(this,p.String,null)}static createBytesType(){return this.createArrayType(this.createU8Type())}static createOptionType(t){return this.createSumType([new U("some",t),new U("none",this.createProductType([]))])}static createIdentityType(){return this.createProductType([new o("__identity__",this.createU256Type())])}static createConnectionIdType(){return this.createProductType([new o("__connection_id__",this.createU128Type())])}static createScheduleAtType(){return dr.getAlgebraicType()}static createTimestampType(){return this.createProductType([new o("__timestamp_micros_since_unix_epoch__",this.createI64Type())])}static createTimeDurationType(){return this.createProductType([new o("__time_duration_micros__",this.createI64Type())])}isProductType(){return this.type===p.ProductType}isSumType(){return this.type===p.SumType}isArrayType(){return this.type===p.ArrayType}isMapType(){return this.type===p.MapType}isIdentity(){return l(this,P,Ne).call(this,"__identity__")}isConnectionId(){return l(this,P,Ne).call(this,"__connection_id__")}isScheduleAt(){return this.isSumType()&&this.sum.variants.length===2&&this.sum.variants[0].name==="Interval"&&this.sum.variants[0].algebraicType.type===p.U64&&this.sum.variants[1].name==="Time"&&this.sum.variants[1].algebraicType.type===p.U64}isTimestamp(){return l(this,P,Me).call(this,"__timestamp_micros_since_unix_epoch__")}isTimeDuration(){return l(this,P,Me).call(this,"__time_duration_micros__")}serialize(t,r){switch(this.type){case p.ProductType:this.product.serialize(t,r);break;case p.SumType:this.sum.serialize(t,r);break;case p.ArrayType:if(l(this,P,qe).call(this))t.writeUInt8Array(r);else{const s=this.array;t.writeU32(r.length);for(let i of r)s.serialize(t,i)}break;case p.MapType:throw new Error("not implemented");case p.Bool:t.writeBool(r);break;case p.I8:t.writeI8(r);break;case p.U8:t.writeU8(r);break;case p.I16:t.writeI16(r);break;case p.U16:t.writeU16(r);break;case p.I32:t.writeI32(r);break;case p.U32:t.writeU32(r);break;case p.I64:t.writeI64(r);break;case p.U64:t.writeU64(r);break;case p.I128:t.writeI128(r);break;case p.U128:t.writeU128(r);break;case p.I256:t.writeI256(r);break;case p.U256:t.writeU256(r);break;case p.F32:t.writeF32(r);break;case p.F64:t.writeF64(r);break;case p.String:t.writeString(r);break;default:throw new Error(`not implemented, ${this.type}`)}}deserialize(t){switch(this.type){case p.ProductType:return this.product.deserialize(t);case p.SumType:return this.sum.deserialize(t);case p.ArrayType:if(l(this,P,qe).call(this))return t.readUInt8Array();{const r=this.array,s=t.readU32();let i=[];for(let c=0;c<s;c++)i.push(r.deserialize(t));return i}case p.MapType:throw new Error("not implemented");case p.Bool:return t.readBool();case p.I8:return t.readI8();case p.U8:return t.readU8();case p.I16:return t.readI16();case p.U16:return t.readU16();case p.I32:return t.readI32();case p.U32:return t.readU32();case p.I64:return t.readI64();case p.U64:return t.readU64();case p.I128:return t.readI128();case p.U128:return t.readU128();case p.U256:return t.readU256();case p.F32:return t.readF32();case p.F64:return t.readF64();case p.String:return t.readString();default:throw new Error(`not implemented, ${this.type}`)}}},P=new WeakSet,Q=function(t,r){this.type_=r,this.type=r===void 0?p.None:t},_=new WeakSet,v=function(t,r){var i;let s=new G;return l(i=s,P,Q).call(i,t,r),s},qe=function(){return this.isArrayType()&&this.array.type==p.U8},Ne=function(t){return this.isProductType()&&this.product.elements.length===1&&(this.product.elements[0].algebraicType.type==p.U128||this.product.elements[0].algebraicType.type==p.U256)&&this.product.elements[0].name===t},Me=function(t){return this.isProductType()&&this.product.elements.length===1&&this.product.elements[0].algebraicType.type===p.I64&&this.product.elements[0].name===t},f(G,_),G);(e=>{(t=>{t.SumType="SumType",t.ProductType="ProductType",t.ArrayType="ArrayType",t.MapType="MapType",t.Bool="Bool",t.I8="I8",t.U8="U8",t.I16="I16",t.U16="U16",t.I32="I32",t.U32="U32",t.I64="I64",t.U64="U64",t.I128="I128",t.U128="U128",t.I256="I256",t.U256="U256",t.F32="F32",t.F64="F64",t.String="String",t.None="None"})(e.Type||(e.Type={}))})(a);var p=a.Type;function fr(e,t){const r=new re(t);return e.deserialize(r)}var Le;(e=>{e.FixedSize=i=>({tag:"FixedSize",value:i}),e.RowOffsets=i=>({tag:"RowOffsets",value:i});function t(){return a.createSumType([new U("FixedSize",a.createU16Type()),new U("RowOffsets",a.createArrayType(a.createU64Type()))])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Le||(Le={}));var de;(e=>{function t(){return a.createProductType([new o("sizeHint",Le.getTypeScriptAlgebraicType()),new o("rowsData",a.createArrayType(a.createU8Type()))])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(de||(de={}));var He;(e=>{function t(){return a.createProductType([new o("reducer",a.createStringType()),new o("args",a.createArrayType(a.createU8Type())),new o("requestId",a.createU32Type()),new o("flags",a.createU8Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(He||(He={}));var $e;(e=>{function t(){return a.createProductType([new o("queryStrings",a.createArrayType(a.createStringType())),new o("requestId",a.createU32Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})($e||($e={}));var We;(e=>{function t(){return a.createProductType([new o("messageId",a.createArrayType(a.createU8Type())),new o("queryString",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(We||(We={}));var q;(e=>{function t(){return a.createProductType([new o("id",a.createU32Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(q||(q={}));var Ve;(e=>{function t(){return a.createProductType([new o("query",a.createStringType()),new o("requestId",a.createU32Type()),new o("queryId",q.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ve||(Ve={}));var Ge;(e=>{function t(){return a.createProductType([new o("queryStrings",a.createArrayType(a.createStringType())),new o("requestId",a.createU32Type()),new o("queryId",q.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ge||(Ge={}));var Ke;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("queryId",q.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ke||(Ke={}));var Ze;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("queryId",q.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ze||(Ze={}));var te;(e=>{e.CallReducer=i=>({tag:"CallReducer",value:i}),e.Subscribe=i=>({tag:"Subscribe",value:i}),e.OneOffQuery=i=>({tag:"OneOffQuery",value:i}),e.SubscribeSingle=i=>({tag:"SubscribeSingle",value:i}),e.SubscribeMulti=i=>({tag:"SubscribeMulti",value:i}),e.Unsubscribe=i=>({tag:"Unsubscribe",value:i}),e.UnsubscribeMulti=i=>({tag:"UnsubscribeMulti",value:i});function t(){return a.createSumType([new U("CallReducer",He.getTypeScriptAlgebraicType()),new U("Subscribe",$e.getTypeScriptAlgebraicType()),new U("OneOffQuery",We.getTypeScriptAlgebraicType()),new U("SubscribeSingle",Ve.getTypeScriptAlgebraicType()),new U("SubscribeMulti",Ge.getTypeScriptAlgebraicType()),new U("Unsubscribe",Ke.getTypeScriptAlgebraicType()),new U("UnsubscribeMulti",Ze.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(te||(te={}));var Ie;(e=>{function t(){return a.createProductType([new o("deletes",de.getTypeScriptAlgebraicType()),new o("inserts",de.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ie||(Ie={}));var Je;(e=>{e.Uncompressed=i=>({tag:"Uncompressed",value:i}),e.Brotli=i=>({tag:"Brotli",value:i}),e.Gzip=i=>({tag:"Gzip",value:i});function t(){return a.createSumType([new U("Uncompressed",Ie.getTypeScriptAlgebraicType()),new U("Brotli",a.createArrayType(a.createU8Type())),new U("Gzip",a.createArrayType(a.createU8Type()))])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Je||(Je={}));var Ue;(e=>{function t(){return a.createProductType([new o("tableId",a.createU32Type()),new o("tableName",a.createStringType()),new o("numRows",a.createU64Type()),new o("updates",a.createArrayType(Je.getTypeScriptAlgebraicType()))])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ue||(Ue={}));var j;(e=>{function t(){return a.createProductType([new o("tables",a.createArrayType(Ue.getTypeScriptAlgebraicType()))])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(j||(j={}));var Xe;(e=>{function t(){return a.createProductType([new o("quanta",a.createU128Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Xe||(Xe={}));var Ye;(e=>{function t(){return a.createProductType([new o("identity",a.createIdentityType()),new o("token",a.createStringType()),new o("connectionId",a.createConnectionIdType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ye||(Ye={}));var je;(e=>{function t(){return a.createProductType([new o("databaseUpdate",j.getTypeScriptAlgebraicType()),new o("requestId",a.createU32Type()),new o("totalHostExecutionDuration",a.createTimeDurationType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(je||(je={}));var Qe;(e=>{function t(){return a.createProductType([new o("tableName",a.createStringType()),new o("rows",de.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Qe||(Qe={}));var et;(e=>{function t(){return a.createProductType([new o("messageId",a.createArrayType(a.createU8Type())),new o("error",a.createOptionType(a.createStringType())),new o("tables",a.createArrayType(Qe.getTypeScriptAlgebraicType())),new o("totalHostExecutionDuration",a.createTimeDurationType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(et||(et={}));var tt;(e=>{function t(){return a.createProductType([new o("reducerName",a.createStringType()),new o("reducerId",a.createU32Type()),new o("args",a.createArrayType(a.createU8Type())),new o("requestId",a.createU32Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(tt||(tt={}));var rt;(e=>{e.Committed=i=>({tag:"Committed",value:i}),e.Failed=i=>({tag:"Failed",value:i}),e.OutOfEnergy={tag:"OutOfEnergy"};function t(){return a.createSumType([new U("Committed",j.getTypeScriptAlgebraicType()),new U("Failed",a.createStringType()),new U("OutOfEnergy",a.createProductType([]))])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(rt||(rt={}));var it;(e=>{function t(){return a.createProductType([new o("status",rt.getTypeScriptAlgebraicType()),new o("timestamp",a.createTimestampType()),new o("callerIdentity",a.createIdentityType()),new o("callerConnectionId",a.createConnectionIdType()),new o("reducerCall",tt.getTypeScriptAlgebraicType()),new o("energyQuantaUsed",Xe.getTypeScriptAlgebraicType()),new o("totalHostExecutionDuration",a.createTimeDurationType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(it||(it={}));var nt;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("update",j.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(nt||(nt={}));var _e;(e=>{function t(){return a.createProductType([new o("tableId",a.createU32Type()),new o("tableName",a.createStringType()),new o("tableRows",Ue.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(_e||(_e={}));var st;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("totalHostExecutionDurationMicros",a.createU64Type()),new o("queryId",q.getTypeScriptAlgebraicType()),new o("rows",_e.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(st||(st={}));var at;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("totalHostExecutionDurationMicros",a.createU64Type()),new o("queryId",q.getTypeScriptAlgebraicType()),new o("rows",_e.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(at||(at={}));var ct;(e=>{function t(){return a.createProductType([new o("totalHostExecutionDurationMicros",a.createU64Type()),new o("requestId",a.createOptionType(a.createU32Type())),new o("queryId",a.createOptionType(a.createU32Type())),new o("tableId",a.createOptionType(a.createU32Type())),new o("error",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(ct||(ct={}));var ot;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("totalHostExecutionDurationMicros",a.createU64Type()),new o("queryId",q.getTypeScriptAlgebraicType()),new o("update",j.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(ot||(ot={}));var pt;(e=>{function t(){return a.createProductType([new o("requestId",a.createU32Type()),new o("totalHostExecutionDurationMicros",a.createU64Type()),new o("queryId",q.getTypeScriptAlgebraicType()),new o("update",j.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(pt||(pt={}));var lt;(e=>{e.InitialSubscription=i=>({tag:"InitialSubscription",value:i}),e.TransactionUpdate=i=>({tag:"TransactionUpdate",value:i}),e.TransactionUpdateLight=i=>({tag:"TransactionUpdateLight",value:i}),e.IdentityToken=i=>({tag:"IdentityToken",value:i}),e.OneOffQueryResponse=i=>({tag:"OneOffQueryResponse",value:i}),e.SubscribeApplied=i=>({tag:"SubscribeApplied",value:i}),e.UnsubscribeApplied=i=>({tag:"UnsubscribeApplied",value:i}),e.SubscriptionError=i=>({tag:"SubscriptionError",value:i}),e.SubscribeMultiApplied=i=>({tag:"SubscribeMultiApplied",value:i}),e.UnsubscribeMultiApplied=i=>({tag:"UnsubscribeMultiApplied",value:i});function t(){return a.createSumType([new U("InitialSubscription",je.getTypeScriptAlgebraicType()),new U("TransactionUpdate",it.getTypeScriptAlgebraicType()),new U("TransactionUpdateLight",nt.getTypeScriptAlgebraicType()),new U("IdentityToken",Ye.getTypeScriptAlgebraicType()),new U("OneOffQueryResponse",et.getTypeScriptAlgebraicType()),new U("SubscribeApplied",st.getTypeScriptAlgebraicType()),new U("UnsubscribeApplied",at.getTypeScriptAlgebraicType()),new U("SubscriptionError",ct.getTypeScriptAlgebraicType()),new U("SubscribeMultiApplied",ot.getTypeScriptAlgebraicType()),new U("UnsubscribeMultiApplied",pt.getTypeScriptAlgebraicType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(lt||(lt={}));var K,xt,Oe=(xt=class{constructor(){f(this,K,new Map)}on(e,t){let r=n(this,K).get(e);r||(r=new Set,n(this,K).set(e,r)),r.add(t)}off(e,t){let r=n(this,K).get(e);r&&r.delete(t)}emit(e,...t){let r=n(this,K).get(e);if(r)for(let s of r)s(...t)}},K=new WeakMap,xt),R,Z,ye,Ot,Ct=(Ot=class{constructor(){f(this,Z);f(this,R,[])}set(e,t){const r=n(this,R).findIndex(({key:s})=>l(this,Z,ye).call(this,s,e));r>-1?n(this,R)[r].value=t:n(this,R).push({key:e,value:t})}get(e){const t=n(this,R).find(({key:r})=>l(this,Z,ye).call(this,r,e));return t?t.value:void 0}delete(e){const t=n(this,R).findIndex(({key:r})=>l(this,Z,ye).call(this,r,e));return t>-1?(n(this,R).splice(t,1),!0):!1}has(e){return n(this,R).some(({key:t})=>l(this,Z,ye).call(this,t,e))}values(){return n(this,R).map(e=>e.value)}entries(){return n(this,R)}[Symbol.iterator](){let e=0;const t=n(this,R);return{next(){return e<t.length?{value:t[e++],done:!1}:{value:null,done:!0}}}}},R=new WeakMap,Z=new WeakSet,ye=function(e,t){return e&&typeof e=="object"&&"isEqual"in e?e.isEqual(t):e===t},Ot),mr={component:"📦",info:"ℹ️",warn:"⚠️",error:"❌",debug:"🐛"},wr={component:"color: #fff; background-color: #8D6FDD; padding: 2px 5px; border-radius: 3px;",info:"color: #fff; background-color: #007bff; padding: 2px 5px; border-radius: 3px;",warn:"color: #fff; background-color: #ffc107; padding: 2px 5px; border-radius: 3px;",error:"color: #fff; background-color: #dc3545; padding: 2px 5px; border-radius: 3px;",debug:"color: #fff; background-color: #28a745; padding: 2px 5px; border-radius: 3px;"},Sr={component:"color: #8D6FDD;",info:"color: #007bff;",warn:"color: #ffc107;",error:"color: #dc3545;",debug:"color: #28a745;"},ge=(e,t)=>{console.log(`%c${mr[e]} ${e.toUpperCase()}%c ${t}`,wr[e],Sr[e])},Ar=class{constructor(e){y(this,"rows");y(this,"tableTypeInfo");y(this,"emitter");y(this,"applyOperations",(e,t)=>{const r=[];if(this.tableTypeInfo.primaryKey!==void 0){const s=this.tableTypeInfo.primaryKey,i=new Ct,c=new Ct;for(const b of e)if(b.type==="insert"){const[h,T]=i.get(b.row[s])||[b,0];i.set(b.row[s],[b,T+1])}else{const[h,T]=c.get(b.row[s])||[b,0];c.set(b.row[s],[b,T+1])}for(const{key:b,value:[h,T]}of i){const z=c.get(b);if(z){const[m,S]=z,C=T-S,O=this.update(t,h,m,C);O&&r.push(O),c.delete(b)}else{const m=this.insert(t,h,T);m&&r.push(m)}}for(const[b,h]of c.values()){const T=this.delete(t,b,h);T&&r.push(T)}}else for(const s of e)if(s.type==="insert"){const i=this.insert(t,s);i&&r.push(i)}else{const i=this.delete(t,s);i&&r.push(i)}return r});y(this,"update",(e,t,r,s=0)=>{const[i,c]=this.rows.get(r.rowId)||[r.row,0],b=Math.max(1,c+s);return this.rows.delete(r.rowId),this.rows.set(t.rowId,[t.row,b]),c===0?(ge("error","Updating a row that was not present in the cache"),{type:"insert",table:this.tableTypeInfo.tableName,cb:()=>{this.emitter.emit("insert",e,t.row)}}):(c+s<=0&&ge("error","Negative reference count for row"),{type:"update",table:this.tableTypeInfo.tableName,cb:()=>{this.emitter.emit("update",e,i,t.row)}})});y(this,"insert",(e,t,r=1)=>{const[s,i]=this.rows.get(t.rowId)||[t.row,0];if(this.rows.set(t.rowId,[t.row,i+r]),i===0)return{type:"insert",table:this.tableTypeInfo.tableName,cb:()=>{this.emitter.emit("insert",e,t.row)}}});y(this,"delete",(e,t,r=1)=>{const[s,i]=this.rows.get(t.rowId)||[t.row,0];if(i===0){ge("warn","Deleting a row that was not present in the cache");return}if(i<=r)return this.rows.delete(t.rowId),{type:"delete",table:this.tableTypeInfo.tableName,cb:()=>{this.emitter.emit("delete",e,t.row)}};this.rows.set(t.rowId,[t.row,i-r])});y(this,"onInsert",e=>{this.emitter.on("insert",e)});y(this,"onDelete",e=>{this.emitter.on("delete",e)});y(this,"onUpdate",e=>{this.emitter.on("update",e)});y(this,"removeOnInsert",e=>{this.emitter.off("insert",e)});y(this,"removeOnDelete",e=>{this.emitter.off("delete",e)});y(this,"removeOnUpdate",e=>{this.emitter.off("update",e)});this.tableTypeInfo=e,this.rows=new Map,this.emitter=new Oe}count(){return this.rows.size}iter(){return Array.from(this.rows.values()).map(([e])=>e)}},zr=class{constructor(){y(this,"tables");this.tables=new Map}getTable(e){const t=this.tables.get(e);if(!t)throw console.error("The table has not been registered for this client. Please register the table before using it. If you have registered global tables using the SpacetimeDBClient.registerTables() or `registerTable()` method, please make sure that is executed first!"),new Error(`Table ${e} does not exist`);return t}getOrCreateTable(e){let t;return this.tables.has(e.tableName)?t=this.tables.get(e.tableName):(t=new Ar(e),this.tables.set(e.tableName,t)),t}};async function Wt(e,t,r=128*1024){let s=0;const i=new ReadableStream({pull(O){if(s<e.length){const L=e.subarray(s,Math.min(s+r,e.length));O.enqueue(L),s+=r}else O.close()}}),c=new DecompressionStream(t),h=i.pipeThrough(c).getReader(),T=[];let z=0,m;for(;!(m=await h.read()).done;)T.push(m.value),z+=m.value.length;const S=new Uint8Array(z);let C=0;for(const O of T)S.set(O,C),C+=O.length;return S}var ie,M,Vt,Gt,ut,ne,Ir=(ne=class{constructor(t){f(this,M);y(this,"onclose");y(this,"onopen");y(this,"onmessage");y(this,"onerror");f(this,ie);this.onmessage=void 0,this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,t.onmessage=l(this,M,Vt).bind(this),t.onerror=l(this,M,ut).bind(this),t.onclose=l(this,M,ut).bind(this),t.onopen=l(this,M,Gt).bind(this),t.binaryType="arraybuffer",u(this,ie,t)}send(t){n(this,ie).send(t)}close(){n(this,ie).close()}static async createWebSocketFn({url:t,wsProtocol:r,authToken:s,compression:i,lightMode:c}){const b=new Headers;let h;if(h=WebSocket,s){b.set("Authorization",`Bearer ${s}`);const z=new URL("/v1/identity/websocket-token",t);z.protocol=t.protocol==="wss:"?"https:":"http:";const m=await fetch(z,{method:"POST",headers:b});if(m.ok){const{token:S}=await m.json();t.searchParams.set("token",S),t.searchParams.set("compression",i==="gzip"?"Gzip":"None"),c&&t.searchParams.set("light","true")}}const T=new h(t,r);return new ne(T)}},ie=new WeakMap,M=new WeakSet,Vt=async function(t){var i;const r=new Uint8Array(t.data);let s;if(r[0]===0)s=r.slice(1);else{if(r[0]===1)throw new Error("Brotli Compression not supported. Please use gzip or none compression in withCompression method on DbConnection.");if(r[0]===2)s=await Wt(r.slice(1),"gzip");else throw new Error("Unexpected Compression Algorithm. Please use `gzip` or `none`")}(i=this.onmessage)==null||i.call(this,{data:s})},Gt=function(t){var r;(r=this.onopen)==null||r.call(this,t)},ut=function(t){var r;(r=this.onerror)==null||r.call(this,t)},ne),se,ae,ke,he,J,Te,be,ce,Et,Ur=(Et=class{constructor(e,t){f(this,se);f(this,ae);f(this,ke);f(this,he);f(this,J,new Oe);f(this,Te,"gzip");f(this,be,!1);f(this,ce);this.remoteModule=e,this.dbConnectionConstructor=t,u(this,ce,Ir.createWebSocketFn)}withUri(e){return u(this,se,new URL(e)),this}withModuleName(e){return u(this,ae,e),this}withToken(e){return u(this,he,e),this}withWSFn(e){return u(this,ce,e),this}withCompression(e){return u(this,Te,e),this}withLightMode(e){return u(this,be,e),this}onConnect(e){return n(this,J).on("connect",e),this}onConnectError(e){return n(this,J).on("connectError",e),this}onDisconnect(e){return n(this,J).on("disconnect",e),this}build(){if(!n(this,se))throw new Error("URI is required to connect to SpacetimeDB");if(!n(this,ae))throw new Error("Database name or address is required to connect to SpacetimeDB");return this.dbConnectionConstructor(new Zt({uri:n(this,se),nameOrAddress:n(this,ae),identity:n(this,ke),token:n(this,he),emitter:n(this,J),compression:n(this,Te),lightMode:n(this,be),createWSFn:n(this,ce),remoteModule:this.remoteModule}))}},se=new WeakMap,ae=new WeakMap,ke=new WeakMap,he=new WeakMap,J=new WeakMap,Te=new WeakMap,be=new WeakMap,ce=new WeakMap,Et),fe,me,Rt,Kt=(Rt=class{constructor(e){f(this,fe);f(this,me);this.db=e}onApplied(e){return u(this,fe,e),this}onError(e){return u(this,me,e),this}subscribe(e){const t=Array.isArray(e)?e:[e];if(t.length===0)throw new Error("Subscriptions must have at least one query");return new vr(this.db,t,n(this,fe),n(this,me))}subscribeToAllTables(){this.subscribe("SELECT * FROM *")}},fe=new WeakMap,me=new WeakMap,Rt),_r=class{constructor(){y(this,"subscriptions",new Map)}},oe,X,pe,le,Y,Dt,vr=(Dt=class{constructor(e,t,r,s){f(this,oe);f(this,X,!1);f(this,pe,!1);f(this,le,!1);f(this,Y,new Oe);this.db=e,this.onError=s,n(this,Y).on("applied",i=>{u(this,le,!0),r&&r(i)}),n(this,Y).on("error",(i,c)=>{this.onError&&this.onError(i,c)}),u(this,oe,this.db.registerSubscription(this,n(this,Y),t))}unsubscribe(){if(n(this,X))throw new Error("Unsubscribe has already been called");u(this,X,!0),this.db.unregisterSubscription(n(this,oe)),this.db.unsubscribe(n(this,oe))}unsubscribeThen(e){if(n(this,pe))throw new Error("Subscription has already ended");if(n(this,X))throw new Error("Unsubscribe has already been called");u(this,X,!0),n(this,Y).on("end",t=>{u(this,pe,!0),u(this,le,!1),e(t)})}isEnded(){return n(this,pe)}isActive(){return n(this,le)}},oe=new WeakMap,X=new WeakMap,pe=new WeakMap,le=new WeakMap,Y=new WeakMap,Dt);function Fr(e){switch(e){case"FullUpdate":return 0;case"NoSuccessNotify":return 1}}var we,x,ue,Pe,k,Se,H,xe,A,Jt,ze,Xt,W,Yt,jt,Qt,Cr,Br,kr,Pr,xr,Or,Er,qt,Zt=(qt=class{constructor({uri:e,nameOrAddress:t,identity:r,token:s,emitter:i,remoteModule:c,createWSFn:b,compression:h,lightMode:T}){f(this,A);y(this,"isActive",!1);y(this,"identity");y(this,"token");y(this,"db");y(this,"reducers");y(this,"setReducerFlags");y(this,"connectionId",Re.random());f(this,we,0);f(this,x);f(this,ue,new Oe);f(this,Pe);f(this,k);f(this,Se,Promise.resolve());f(this,H,new _r);y(this,"clientCache");y(this,"ws");y(this,"wsPromise");f(this,xe,()=>{const e=n(this,we);return u(this,we,n(this,we)+1),e});y(this,"subscriptionBuilder",()=>new Kt(this));ge("info","Connecting to SpacetimeDB WS...");let z=new URL(`v1/database/${t}/subscribe`,e);/^wss?:/.test(e.protocol)||(z.protocol="ws:"),this.identity=r,this.token=s,u(this,k,c),u(this,x,i);let m=this.connectionId.toHexString();z.searchParams.set("connection_id",m),this.clientCache=new zr,this.db=n(this,k).dbViewConstructor(this),this.setReducerFlags=n(this,k).setReducerFlagsConstructor(),this.reducers=n(this,k).reducersConstructor(this,this.setReducerFlags),this.wsPromise=b({url:z,wsProtocol:"v1.bsatn.spacetimedb",authToken:s,compression:h,lightMode:T}).then(S=>(this.ws=S,this.ws.onclose=()=>{n(this,x).emit("disconnect",this)},this.ws.onerror=C=>{n(this,x).emit("connectError",this,C)},this.ws.onopen=l(this,A,Xt).bind(this),this.ws.onmessage=l(this,A,jt).bind(this),S)).catch(S=>{throw ge("error","Error connecting to SpacetimeDB WS"),l(this,A,Qt).call(this,"connectError",S),S})}registerSubscription(e,t,r){const s=n(this,xe).call(this);return n(this,H).subscriptions.set(s,{handle:e,emitter:t}),l(this,A,ze).call(this,te.SubscribeMulti({queryStrings:r,queryId:{id:s},requestId:0})),s}unregisterSubscription(e){l(this,A,ze).call(this,te.UnsubscribeMulti({queryId:{id:e},requestId:0}))}callReducer(e,t,r){const s=te.CallReducer({reducer:e,args:t,requestId:0,flags:Fr(r)});l(this,A,ze).call(this,s)}disconnect(){this.wsPromise.then(e=>{e.close()})}onReducer(e,t){n(this,ue).on(e,t)}offReducer(e,t){n(this,ue).off(e,t)}},we=new WeakMap,x=new WeakMap,ue=new WeakMap,Pe=new WeakMap,k=new WeakMap,Se=new WeakMap,H=new WeakMap,xe=new WeakMap,A=new WeakSet,Jt=async function(e){const t=(i,c,b)=>{const h=b.rowsData,T=new re(h),z=[],m=n(this,k).tables[c].rowType;for(;T.offset<h.length+h.byteOffset;){const S=m.deserialize(T),C=JSON.stringify(S,(O,L)=>typeof L=="bigint"?L.toString():L);z.push({type:i,rowId:C,row:S})}return z},r=async i=>{const c=i.tableName;let b=[];for(const h of i.updates){let T;if(h.tag==="Gzip"){const z=await Wt(h.value,"gzip");T=Ie.deserialize(new re(z))}else{if(h.tag==="Brotli")throw new Error("Brotli compression not supported. Please use gzip or none compression in withCompression method on DbConnection.");T=h.value}b=b.concat(t("insert",c,T.inserts)),b=b.concat(t("delete",c,T.deletes))}return{tableName:c,operations:b}},s=async i=>{const c=[];for(const b of i.tables)c.push(await r(b));return c};switch(e.tag){case"InitialSubscription":{const i=e.value.databaseUpdate;return{tag:"InitialSubscription",tableUpdates:await s(i)}}case"TransactionUpdateLight":{const i=e.value.update;return{tag:"TransactionUpdateLight",tableUpdates:await s(i)}}case"TransactionUpdate":{const i=e.value,c=i.callerIdentity,b=Re.nullIfZero(i.callerConnectionId),h=i.reducerCall.reducerName,T=i.reducerCall.args,z=i.energyQuantaUsed;let m,S="";switch(i.status.tag){case"Committed":m=await s(i.status.value);break;case"Failed":m=[],S=i.status.value;break;case"OutOfEnergy":m=[];break}if(h==="<none>"){console.error(`Received an error from the database: ${S}`);return}let C;return h!==""&&(C={reducerName:h,args:T}),{tag:"TransactionUpdate",tableUpdates:m,identity:c,connectionId:b,reducerInfo:C,status:i.status,energyConsumed:z.quanta,message:S,timestamp:i.timestamp}}case"IdentityToken":return{tag:"IdentityToken",identity:e.value.identity,token:e.value.token,connectionId:e.value.connectionId};case"OneOffQueryResponse":throw new Error(`TypeScript SDK never sends one-off queries, but got OneOffQueryResponse ${e}`);case"SubscribeMultiApplied":{const i=await s(e.value.update);return{tag:"SubscribeApplied",queryId:e.value.queryId.id,tableUpdates:i}}case"UnsubscribeMultiApplied":{const i=await s(e.value.update);return{tag:"UnsubscribeApplied",queryId:e.value.queryId.id,tableUpdates:i}}case"SubscriptionError":return{tag:"SubscriptionError",queryId:e.value.queryId,error:e.value.error}}},ze=function(e){this.wsPromise.then(t=>{const r=new V(1024);te.serialize(r,e);const s=r.getBuffer();t.send(s)})},Xt=function(){this.isActive=!0},W=function(e,t){const r=[];for(let s of e){const i=s.tableName,c=n(this,k).tables[i],b=this.clientCache.getOrCreateTable(c);r.push(...b.applyOperations(s.operations,t))}return r},Yt=async function(e){var s,i,c,b;const t=fr(lt,e),r=await l(this,A,Jt).call(this,t);if(r)switch(r.tag){case"InitialSubscription":{let h={tag:"SubscribeApplied"};const T=n(this,k).eventContextConstructor(this,h),{event:z,...m}=T,S=l(this,A,W).call(this,r.tableUpdates,T);n(this,x)&&((s=n(this,Pe))==null||s.call(this,m));for(const C of S)C.cb();break}case"TransactionUpdateLight":{let h={tag:"UnknownTransaction"};const T=n(this,k).eventContextConstructor(this,h),z=l(this,A,W).call(this,r.tableUpdates,T);for(const m of z)m.cb();break}case"TransactionUpdate":{let h=r.reducerInfo,T=!1,z,m;if(!h)T=!0;else{m=n(this,k).reducers[h.reducerName];try{const $=new re(h.args);z=m.argsType.deserialize($)}catch{console.debug("Failed to deserialize reducer arguments"),T=!0}}if(T){const $={tag:"UnknownTransaction"},vt=n(this,k).eventContextConstructor(this,$),tr=l(this,A,W).call(this,r.tableUpdates,vt);for(const rr of tr)rr.cb();return}h=h,m=m;const S={callerIdentity:r.identity,status:r.status,callerConnectionId:r.connectionId,timestamp:r.timestamp,energyConsumed:r.energyConsumed,reducer:{name:h.reducerName,args:z}},C={tag:"Reducer",value:S},O=n(this,k).eventContextConstructor(this,C),L={...O,event:S},er=l(this,A,W).call(this,r.tableUpdates,O),_t=[];m.argsType.product.elements.forEach(($,vt)=>{_t.push(z[$.name])}),n(this,ue).emit(h.reducerName,L,..._t);for(const $ of er)$.cb();break}case"IdentityToken":{this.identity=r.identity,!this.token&&r.token&&(this.token=r.token),this.connectionId=r.connectionId,n(this,x).emit("connect",this,this.identity,this.token);break}case"SubscribeApplied":{const h={tag:"SubscribeApplied"},T=n(this,k).eventContextConstructor(this,h),{event:z,...m}=T,S=l(this,A,W).call(this,r.tableUpdates,T);(i=n(this,H).subscriptions.get(r.queryId))==null||i.emitter.emit("applied",m);for(const C of S)C.cb();break}case"UnsubscribeApplied":{const h={tag:"UnsubscribeApplied"},T=n(this,k).eventContextConstructor(this,h),{event:z,...m}=T,S=l(this,A,W).call(this,r.tableUpdates,T);(c=n(this,H).subscriptions.get(r.queryId))==null||c.emitter.emit("end",m);for(const C of S)C.cb();break}case"SubscriptionError":{const h=Error(r.error),T={tag:"Error",value:h},m={...n(this,k).eventContextConstructor(this,T),event:h};r.queryId?(b=n(this,H).subscriptions.get(r.queryId))==null||b.emitter.emit("error",m,h):(console.error("Received an error message without a queryId: ",h),n(this,H).subscriptions.forEach(({emitter:S})=>{S.emit("error",m,h)}))}}},jt=function(e){u(this,Se,n(this,Se).then(()=>l(this,A,Yt).call(this,e.data)))},Qt=function(e,t){n(this,x).on(e,t)},Cr=function(e,t){n(this,x).off(e,t)},Br=function(e){n(this,x).on("connect",e)},kr=function(e){n(this,x).on("disconnect",e)},Pr=function(e){n(this,x).on("connectError",e)},xr=function(e){n(this,x).off("connect",e)},Or=function(e){n(this,x).off("disconnect",e)},Er=function(e){n(this,x).off("connectError",e)},qt),yt;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(yt||(yt={}));var ve;(e=>{function t(){return a.createProductType([new o("message",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(ve||(ve={}));var gt;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(gt||(gt={}));var dt;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(dt||(dt={}));var ht;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(ht||(ht={}));var Tt;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Tt||(Tt={}));var Fe;(e=>{function t(){return a.createProductType([new o("text",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Fe||(Fe={}));var Ce;(e=>{function t(){return a.createProductType([new o("name",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Ce||(Ce={}));var bt;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(bt||(bt={}));var Be;(e=>{function t(){return a.createProductType([new o("newStatus",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(Be||(Be={}));var ft;(e=>{function t(){return a.createProductType([])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(ft||(ft={}));class Rr{constructor(t){this.onInsert=r=>this.tableCache.onInsert(r),this.removeOnInsert=r=>this.tableCache.removeOnInsert(r),this.onDelete=r=>this.tableCache.onDelete(r),this.removeOnDelete=r=>this.tableCache.removeOnDelete(r),this.tableCache=t}count(){return this.tableCache.count()}iter(){return this.tableCache.iter()}}class Dr{constructor(t){this.id={find:r=>{for(let s of this.tableCache.iter())if(It(s.id,r))return s}},this.onInsert=r=>this.tableCache.onInsert(r),this.removeOnInsert=r=>this.tableCache.removeOnInsert(r),this.onDelete=r=>this.tableCache.onDelete(r),this.removeOnDelete=r=>this.tableCache.removeOnDelete(r),this.onUpdate=r=>this.tableCache.onUpdate(r),this.removeOnUpdate=r=>this.tableCache.removeOnUpdate(r),this.tableCache=t}count(){return this.tableCache.count()}iter(){return this.tableCache.iter()}}class qr{constructor(t){this.onInsert=r=>this.tableCache.onInsert(r),this.removeOnInsert=r=>this.tableCache.removeOnInsert(r),this.onDelete=r=>this.tableCache.onDelete(r),this.removeOnDelete=r=>this.tableCache.removeOnDelete(r),this.tableCache=t}count(){return this.tableCache.count()}iter(){return this.tableCache.iter()}}class Nr{constructor(t){this.onInsert=r=>this.tableCache.onInsert(r),this.removeOnInsert=r=>this.tableCache.removeOnInsert(r),this.onDelete=r=>this.tableCache.onDelete(r),this.removeOnDelete=r=>this.tableCache.removeOnDelete(r),this.tableCache=t}count(){return this.tableCache.count()}iter(){return this.tableCache.iter()}}class Mr{constructor(t){this.identity={find:r=>{for(let s of this.tableCache.iter())if(It(s.identity,r))return s}},this.onInsert=r=>this.tableCache.onInsert(r),this.removeOnInsert=r=>this.tableCache.removeOnInsert(r),this.onDelete=r=>this.tableCache.onDelete(r),this.removeOnDelete=r=>this.tableCache.removeOnDelete(r),this.onUpdate=r=>this.tableCache.onUpdate(r),this.removeOnUpdate=r=>this.tableCache.removeOnUpdate(r),this.tableCache=t}count(){return this.tableCache.count()}iter(){return this.tableCache.iter()}}var mt;(e=>{function t(){return a.createProductType([new o("identity",a.createIdentityType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(mt||(mt={}));var wt;(e=>{function t(){return a.createProductType([new o("id",a.createU32Type()),new o("message",a.createStringType()),new o("lastUpdated",a.createU64Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(wt||(wt={}));var St;(e=>{function t(){return a.createProductType([new o("sender",a.createIdentityType()),new o("sent",a.createU64Type()),new o("text",a.createStringType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(St||(St={}));var At;(e=>{function t(){return a.createProductType([new o("updateId",a.createU64Type()),new o("message",a.createStringType()),new o("timestamp",a.createU64Type())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(At||(At={}));var zt;(e=>{function t(){return a.createProductType([new o("identity",a.createIdentityType()),new o("name",a.createOptionType(a.createStringType())),new o("online",a.createBoolType())])}e.getTypeScriptAlgebraicType=t;function r(i,c){e.getTypeScriptAlgebraicType().serialize(i,c)}e.serialize=r;function s(i){return e.getTypeScriptAlgebraicType().deserialize(i)}e.deserialize=s})(zt||(zt={}));const ee={tables:{admin:{tableName:"admin",rowType:mt.getTypeScriptAlgebraicType()},current_status:{tableName:"current_status",rowType:wt.getTypeScriptAlgebraicType(),primaryKey:"id"},message:{tableName:"message",rowType:St.getTypeScriptAlgebraicType()},update_log:{tableName:"update_log",rowType:At.getTypeScriptAlgebraicType()},user:{tableName:"user",rowType:zt.getTypeScriptAlgebraicType(),primaryKey:"identity"}},reducers:{add_admin:{reducerName:"add_admin",argsType:yt.getTypeScriptAlgebraicType()},add_update:{reducerName:"add_update",argsType:ve.getTypeScriptAlgebraicType()},connect:{reducerName:"connect",argsType:gt.getTypeScriptAlgebraicType()},debug_admins:{reducerName:"debug_admins",argsType:dt.getTypeScriptAlgebraicType()},disconnect:{reducerName:"disconnect",argsType:ht.getTypeScriptAlgebraicType()},force_init:{reducerName:"force_init",argsType:Tt.getTypeScriptAlgebraicType()},send_message:{reducerName:"send_message",argsType:Fe.getTypeScriptAlgebraicType()},set_name:{reducerName:"set_name",argsType:Ce.getTypeScriptAlgebraicType()},test_log:{reducerName:"test_log",argsType:bt.getTypeScriptAlgebraicType()},update_status:{reducerName:"update_status",argsType:Be.getTypeScriptAlgebraicType()},view_status:{reducerName:"view_status",argsType:ft.getTypeScriptAlgebraicType()}},eventContextConstructor:(e,t)=>({...e,event:t}),dbViewConstructor:e=>new $r(e),reducersConstructor:(e,t)=>new Lr(e,t),setReducerFlagsConstructor:()=>new Hr};class Lr{constructor(t,r){this.connection=t,this.setCallReducerFlags=r}addAdmin(){this.connection.callReducer("add_admin",new Uint8Array(0),this.setCallReducerFlags.addAdminFlags)}onAddAdmin(t){this.connection.onReducer("add_admin",t)}removeOnAddAdmin(t){this.connection.offReducer("add_admin",t)}addUpdate(t){const r={message:t};let s=new V(1024);ve.getTypeScriptAlgebraicType().serialize(s,r);let i=s.getBuffer();this.connection.callReducer("add_update",i,this.setCallReducerFlags.addUpdateFlags)}onAddUpdate(t){this.connection.onReducer("add_update",t)}removeOnAddUpdate(t){this.connection.offReducer("add_update",t)}onConnect(t){this.connection.onReducer("connect",t)}removeOnConnect(t){this.connection.offReducer("connect",t)}debugAdmins(){this.connection.callReducer("debug_admins",new Uint8Array(0),this.setCallReducerFlags.debugAdminsFlags)}onDebugAdmins(t){this.connection.onReducer("debug_admins",t)}removeOnDebugAdmins(t){this.connection.offReducer("debug_admins",t)}onDisconnect(t){this.connection.onReducer("disconnect",t)}removeOnDisconnect(t){this.connection.offReducer("disconnect",t)}forceInit(){this.connection.callReducer("force_init",new Uint8Array(0),this.setCallReducerFlags.forceInitFlags)}onForceInit(t){this.connection.onReducer("force_init",t)}removeOnForceInit(t){this.connection.offReducer("force_init",t)}sendMessage(t){const r={text:t};let s=new V(1024);Fe.getTypeScriptAlgebraicType().serialize(s,r);let i=s.getBuffer();this.connection.callReducer("send_message",i,this.setCallReducerFlags.sendMessageFlags)}onSendMessage(t){this.connection.onReducer("send_message",t)}removeOnSendMessage(t){this.connection.offReducer("send_message",t)}setName(t){const r={name:t};let s=new V(1024);Ce.getTypeScriptAlgebraicType().serialize(s,r);let i=s.getBuffer();this.connection.callReducer("set_name",i,this.setCallReducerFlags.setNameFlags)}onSetName(t){this.connection.onReducer("set_name",t)}removeOnSetName(t){this.connection.offReducer("set_name",t)}testLog(){this.connection.callReducer("test_log",new Uint8Array(0),this.setCallReducerFlags.testLogFlags)}onTestLog(t){this.connection.onReducer("test_log",t)}removeOnTestLog(t){this.connection.offReducer("test_log",t)}updateStatus(t){const r={newStatus:t};let s=new V(1024);Be.getTypeScriptAlgebraicType().serialize(s,r);let i=s.getBuffer();this.connection.callReducer("update_status",i,this.setCallReducerFlags.updateStatusFlags)}onUpdateStatus(t){this.connection.onReducer("update_status",t)}removeOnUpdateStatus(t){this.connection.offReducer("update_status",t)}viewStatus(){this.connection.callReducer("view_status",new Uint8Array(0),this.setCallReducerFlags.viewStatusFlags)}onViewStatus(t){this.connection.onReducer("view_status",t)}removeOnViewStatus(t){this.connection.offReducer("view_status",t)}}class Hr{constructor(){this.addAdminFlags="FullUpdate",this.addUpdateFlags="FullUpdate",this.debugAdminsFlags="FullUpdate",this.forceInitFlags="FullUpdate",this.sendMessageFlags="FullUpdate",this.setNameFlags="FullUpdate",this.testLogFlags="FullUpdate",this.updateStatusFlags="FullUpdate",this.viewStatusFlags="FullUpdate"}addAdmin(t){this.addAdminFlags=t}addUpdate(t){this.addUpdateFlags=t}debugAdmins(t){this.debugAdminsFlags=t}forceInit(t){this.forceInitFlags=t}sendMessage(t){this.sendMessageFlags=t}setName(t){this.setNameFlags=t}testLog(t){this.testLogFlags=t}updateStatus(t){this.updateStatusFlags=t}viewStatus(t){this.viewStatusFlags=t}}class $r{constructor(t){this.connection=t}get admin(){return new Rr(this.connection.clientCache.getOrCreateTable(ee.tables.admin))}get currentStatus(){return new Dr(this.connection.clientCache.getOrCreateTable(ee.tables.current_status))}get message(){return new qr(this.connection.clientCache.getOrCreateTable(ee.tables.message))}get updateLog(){return new Nr(this.connection.clientCache.getOrCreateTable(ee.tables.update_log))}get user(){return new Mr(this.connection.clientCache.getOrCreateTable(ee.tables.user))}}class Wr extends Kt{}const Ut=class Ut extends Zt{constructor(){super(...arguments),this.subscriptionBuilder=()=>new Wr(this)}};Ut.builder=()=>new Ur(ee,t=>t);let Bt=Ut;export{yt as AddAdmin,ve as AddUpdate,mt as Admin,Rr as AdminTableHandle,gt as Connect,wt as CurrentStatus,Dr as CurrentStatusTableHandle,Bt as DbConnection,dt as DebugAdmins,ht as Disconnect,Tt as ForceInit,St as Message,qr as MessageTableHandle,Lr as RemoteReducers,$r as RemoteTables,Fe as SendMessage,Ce as SetName,Hr as SetReducerFlags,Wr as SubscriptionBuilder,bt as TestLog,At as UpdateLog,Nr as UpdateLogTableHandle,Be as UpdateStatus,zt as User,Mr as UserTableHandle,ft as ViewStatus};
